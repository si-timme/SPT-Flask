{% extends "base.html" %}
{% block content %}
<div class="page-header" style="text-align:center;margin-bottom:20px;">
  <h1 style="font-size:2.2em;">Inverse Laplace Transform</h1>
  <p style="color:var(--subtext-color);">Enter a continuous transfer function and view its time-domain response.</p>
</div>

<form method="POST" style="max-width:500px;margin:0 auto;">
  <label for="numerator">Numerator:</label>
  <input type="text" id="numerator" name="numerator" value="{{ default_num }}" required>
  <label for="denominator" style="margin-top:10px;">Denominator:</label>
  <input type="text" id="denominator" name="denominator" value="{{ default_den }}" required>
    <div class="examples" style="margin-top:10px;">
    <button type="button" class="example-btn" data-expr="1/(s**2+3*s+2)">1/(s**2+3*s+2)</button>
    <button type="button" class="example-btn" data-expr="(s+2)/(s**2+4)">(s+2)/(s**2+4)</button>
    <button type="button" class="example-btn" data-expr="s/(s+1)">s/(s+1)</button>
  </div>
  <div style="margin-top:10px;">
    <label><input type="radio" name="response_type" value="step" checked> Step</label>
    <label><input type="radio" name="response_type" value="impulse"> Impulse</label>
  </div>
  <button type="submit" style="margin-top:10px;">Compute</button>
  {% if error %}
    <div class="error">{{ error }}</div>
  {% endif %}
</form>

{% if tf_latex %}
  <div style="text-align:center;margin-top:25px;">
    <h2>Your Transfer Function</h2>
    <p>$$ H(s) = {{ tf_latex|safe }} $$</p>
  </div>
{% endif %}

{% if q_latex %}
  <details style="max-width:500px;margin:20px auto;">
    <summary>Why do Î´(t) and its derivatives appear?</summary>
    <p>For improper transfer functions we perform long division:</p>
    <p>$$H(s)= {{ q_latex|safe }} + {{ r_latex|safe }}$$</p>
  </details>
{% endif %}

{% if latex_expr %}

  <div style="text-align:center;margin-top:20px;">
    <h3>{{ title }}</h3>
    <p>\[ {{ latex_expr|safe }} \]</p>
    <img src="{{ plot_url }}" alt="{{ title }} plot" class="plot">
  </div>
{% endif %}
<script>
  document.querySelectorAll('.example-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const [num, den] = btn.dataset.expr.split('/');
      document.getElementById('numerator').value = num;
      document.getElementById('denominator').value = den;
    });
  });
</script>
{% endblock %}