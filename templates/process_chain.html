{% extends "base.html" %}
{% block content %}

<h2>Process Chain</h2>

<div class="toolbar" style="margin-bottom:10px;">
  <!-- Input expression field -->
  <label>Input x(t):</label>
  <input type="text" id="inputExpression" value="sin(t)" size="15">
  
  <!-- Buttons to add blocks -->
  <button onclick="addBlock('Addition','+')">Add Addition</button>
  <button onclick="addBlock('Subtraction','-')">Add Subtraction</button>
  <button onclick="addBlock('Multiplication','×')">Add Multiplication</button>
  <button onclick="addBlock('Filter','Filter')">Add Filter</button>
  <button onclick="addBlock('Hilbert','Hilbert')">Add Hilbert</button>
  <button onclick="addBlock('Derivative','d/dt')">Add d/dt</button>
  
  <!-- Add Dot or Misc. -->
  <button onclick="addDot()">Add Dot</button>
  <button onclick="toggleConnectMode()">Connect</button>
  
  <!-- Deletion / Clear -->
  <button onclick="deleteSelected()">Delete</button>
  <button onclick="clearAll()">Clear</button>
  
  <!-- (Optionally) a 'Compute' or 'Plot' button that triggers an AJAX to the server -->
  <button onclick="computeChain()">Compute</button>
</div>

<!-- Canvas for the chain UI -->
<canvas id="chainCanvas" width="900" height="500"
  style="border:1px solid #ccc;">
  Your browser does not support Canvas.
</canvas>

<!-- A place to show the final plot (if you do an AJAX approach) -->
<div id="plotResult" style="margin-top:20px;">
  <!-- an <img> for base64 or perhaps some text if we show a symbolic expression -->
</div>

<!-- A hidden modal or overlay for editing block parameters -->
<div id="blockModal" style="display:none; position:fixed; top:50%; left:50%;
     transform:translate(-50%,-50%); width:300px; background:#fff; padding:10px;
     border:2px solid #666; z-index:999;">
  <h3>Edit Block</h3>
  <p id="blockTypeLabel"></p>
  <label>Parameter:</label>
  <input type="text" id="blockParamInput" style="width:80%;">
  
  <div style="margin-top:10px;">
    <button onclick="saveBlockParam()">Save</button>
    <button onclick="closeBlockModal()">Cancel</button>
  </div>
  
  <!-- Possibly add quick function inserts, e.g. "sin(ω₀t)" "LP Filter" etc. -->
</div>

<script src="{{ url_for('static', filename='js/process_chain.js') }}"></script>
{% endblock %}
